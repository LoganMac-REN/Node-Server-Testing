<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ren Internal - Operations</title>
    <link rel="stylesheet" href="../style.css?v=15" />
    <meta http-equiv="Cache-Control" content="no-store" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
  </head>
  <special-header></special-header>
    <main class="content">
      <!-- Professional Header Section -->
      <div class="page-header">
        <div class="header-content">
          <div class="title-section">
            <h1 class="page-title">Operations KPIs</h1>
          </div>
        </div>
      </div>

      <!-- Receiving Section -->
      <div id="receiving-section">
        <!-- Receiving KPIs Report - Full width -->
        <div class="top-report">
          <div class="framecard">
            <iframe
              id="powerbi-frame"
              title="Receiving KPIs Report"
              src="https://app.fabric.microsoft.com/view?r=eyJrIjoiYjliZGE5NDYtZmVhNS00MGMxLWE5MjYtOWQ2ZmMzNTFmNmE0IiwidCI6ImU0YzRmNmNmLTZmZWMtNGFlMy1hN2I3LTdiMzQ3ZWMwMDcyOSJ9"
              allowfullscreen="true"
            >
            </iframe>
          </div>
        </div>
      </div>
      <!-- End of Receiving Section -->
    </main>
    <!-- Top of Page Button -->
    <button class="top-of-page-btn" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" title="Back to top">â†‘</button>

    <script src="../script.js"></script>
    <script src="/customComponents/header.js"></script>
    <!-- Mobile Menu JavaScript -->
    <script>
      // Mobile Menu Functions
      function toggleMobileMenu() {
        const body = document.body;
        const isOpen = body.classList.contains("mobile-menu-open");

        if (isOpen) {
          closeMobileMenu();
        } else {
          body.classList.add("mobile-menu-open");
          // Prevent body scroll when menu is open
          document.body.style.overflow = "hidden";
        }
      }

      function closeMobileMenu() {
        document.body.classList.remove("mobile-menu-open");
        // Restore body scroll
        document.body.style.overflow = "";
      }

      // Mobile Menu Section Toggle Function
      function toggleMobileSection(titleElement) {
        const section = titleElement.parentElement;
        section.classList.toggle("collapsed");
      }

      // Close mobile menu when clicking on overlay
      document.addEventListener("click", function (event) {
        if (event.target.classList.contains("mobile-menu-overlay")) {
          closeMobileMenu();
        }
      });

      // Close mobile menu on window resize if screen becomes large
      window.addEventListener("resize", function () {
        if (window.innerWidth > 768) {
          closeMobileMenu();
        }
      });

      // Enhanced smooth scrolling with offset for anchor links
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute("href"));
          if (target) {
            const headerHeight = document.querySelector(".topbar").offsetHeight;
            const targetPosition = target.offsetTop - headerHeight - 20;

            window.scrollTo({
              top: targetPosition,
              behavior: "smooth",
            });
          }
        });
      });

      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }
    </script>

    <!-- Header Navigation JavaScript -->
    <script>
      function toggleHeaderNav() {
        const menu = document.getElementById("headerNavMenu");
        const button = document.querySelector(".header-nav-button");

        menu.classList.toggle("show");
        button.classList.toggle("active");
      }

      function closeHeaderNav() {
        const menu = document.getElementById("headerNavMenu");
        const button = document.querySelector(".header-nav-button");

        menu.classList.remove("show");
        button.classList.remove("active");
      }

      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "smooth",
        });
      }

      // Close dropdown when clicking outside
      document.addEventListener("click", function (event) {
        const navButton = document.querySelector(".header-nav-button");
        const menu = document.getElementById("headerNavMenu");
        const button = document.querySelector(".header-nav-button");

        if (navButton && !navButton.parentElement.contains(event.target)) {
          menu.classList.remove("show");
          button.classList.remove("active");
        }
      });

      // Enhanced smooth scrolling with offset for anchor links
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute("href"));
          if (target) {
            // Calculate offset to account for header and provide padding
            const headerHeight = document.querySelector(".topbar").offsetHeight;
            const additionalOffset = 30; // Extra padding so title is clearly visible
            const targetPosition = target.offsetTop - headerHeight - additionalOffset;

            window.scrollTo({
              top: targetPosition,
              behavior: "smooth",
            });
          }
        });
      });

      // Initialize mobile menu sections - start with all collapsed except current page section
      document.addEventListener("DOMContentLoaded", function () {
        const sections = document.querySelectorAll(".mobile-menu-section");
        sections.forEach((section) => {
          // Collapse all sections initially
          section.classList.add("collapsed");

          // Keep the section open if it contains the active page
          const activeItem = section.querySelector(".mobile-menu-item.active");
          if (activeItem) {
            section.classList.remove("collapsed");
          }
        });
      });
    </script>
  </body>
</html>
